This is a complete redo of this file. Scratch everything.
